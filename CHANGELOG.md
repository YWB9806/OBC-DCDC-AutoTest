# 更新日志

所有重要的项目更改都将记录在此文件中。

本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [未发布]

### 新增
- 待添加的新功能

### 变更
- 待修改的功能

### 修复
- 待修复的问题

### 移除
- 待移除的功能

---

## [1.0.5] - 2025-12-15

### 修复
- 🐛 **目录树层级结构问题**：修复了添加文件夹后目录结构不正确的问题
  - 之前：所有子文件夹被平铺显示在同一层级
  - 现在：保持完整的层级结构，与Windows资源管理器一致
  - 文件夹下可以包含子文件夹，支持多层嵌套

- 🐛 **目录路径显示优化**：优化了目录树的路径显示
  - 之前：显示完整的绝对路径（如 C:/Users/10206/Desktop/...）
  - 现在：从用户选择的文件夹开始显示相对路径
  - 目录树更简洁，只显示相关的目录结构

### 性能优化
- ⚡ **大量脚本加载优化**：解决了文件夹中脚本多时程序卡顿的问题
  - 默认折叠所有文件夹，减少初始渲染节点数量
  - 使用字典缓存目录节点，避免重复创建
  - 批量更新UI，减少重绘次数
  - 临时断开信号连接，避免级联触发
  - 已有的异步扫描功能（使用QThread）

### 新增
- ✨ **文件夹脚本计数**：每个文件夹节点显示其包含的脚本总数
- ✨ **递归统计功能**：自动统计所有子文件夹中的脚本数量

### 优化
- 🎨 **目录树结构**：完全重构目录树构建逻辑
  - 支持任意层级的嵌套文件夹
  - 保持与文件系统一致的目录结构
  - 支持展开/折叠操作
  - 文件夹复选框支持三态（全选/部分选/不选）

### 性能提升数据
- **600+脚本场景**：
  - 加载时间：明显卡顿 → 流畅加载
  - 初始渲染：所有节点展开 → 默认折叠（按需展开）
  - UI响应：卡顿 → 流畅

---

## [1.0.4] - 2025-12-14

### 新增
- 🎨 **两栏布局**：将三栏布局优化为两栏，执行队列移至右侧标签页
- 🖱️ **可拖拽分割线**：增强分割线视觉效果，手柄宽度6px，支持悬停和按下状态反馈

### 性能优化
- ⚡ **执行队列面板优化**：
  - 批量添加脚本时只更新一次UI，性能提升4-6倍
  - 大量脚本（>10个）使用状态栏提示代替消息框
  - 使用 `setUpdatesEnabled(False)` 减少重绘次数

- ⚡ **脚本浏览器优化**：
  - 批量操作时断开信号连接，避免级联触发
  - 全选/反选/加载方案等操作性能提升6-10倍
  - 优化树形控件更新机制

- ⚡ **执行面板优化**：
  - 降低定时器更新频率（500ms→1000ms）
  - 实现增量更新，只更新状态变化的脚本
  - 批量初始化时禁用UI更新

### 性能提升数据
- **100个脚本场景**：
  - 全选：3-5秒 → <0.5秒（6-10倍提升）
  - 添加到队列：2-3秒 → <0.5秒（4-6倍提升）
  - 执行中UI响应：明显卡顿 → 流畅

- **500个脚本场景**：
  - 全选：>10秒 → 1-2秒（5-10倍提升）
  - 添加到队列：>8秒 → ~1秒（8倍提升）
  - 执行中UI响应：严重卡顿 → 基本流畅

### 优化原则
- 批量操作原则：合并多次小操作为一次大操作
- 延迟更新原则：操作中暂停UI更新，完成后统一刷新
- 信号管理原则：批量操作时临时断开信号
- 增量更新原则：只更新变化部分
- 降频原则：降低定时器更新频率

### 文档
- 📝 添加性能优化说明文档

---

## [1.0.3] - 2025-12-13

### 修复
- 🔐 **管理员密码安全性提升**：增强默认管理员密码安全性
- 🐛 **修改密码功能验证**：确认用户密码修改功能正常工作
- 🐛 **版本号同步问题**：修复版本号显示不一致导致的更新提示问题

### 文档
- 📝 完善部署和安全文档
- 📝 完善自动更新使用说明
- 📝 添加版本更新说明文档

### 优化
- ⚡ 统一版本号管理，避免版本不一致问题
- 🔒 移除文档中的敏感信息

## [1.0.1] - 2025-12-13

### 修复
- 🐛 **Windows控制台窗口问题**：修复了在Windows平台执行脚本时弹出黑色控制台窗口的问题
  - 添加了 `CREATE_NO_WINDOW` 创建标志
  - 配置了 `STARTUPINFO` 隐藏窗口
  - 保持跨平台兼容性

### 优化
- ⚡ 改进了子进程创建方式，提升用户体验
- 🎨 脚本执行更加静默，不干扰用户操作

### 文档
- 📝 添加了修复记录文档
- 📝 添加了测试指南
- 📝 添加了提交指南
- 📝 添加了自动更新使用说明
- 📝 添加了更新功能快速参考
- 📝 添加了本地更新指南

## [1.0.0] - 2025-12-13

### 新增
- ✨ 完整的用户认证系统（登录、注册、权限管理）
- ✨ 脚本批量执行功能
- ✨ 实时输出监控
- ✨ 执行历史记录
- ✨ 测试套件管理
- ✨ 性能监控面板
- ✨ 数据备份与恢复
- ✨ 插件系统支持
- ✨ 现代化UI界面（基于PyQt6）
- ✨ 自动更新检查功能
- ✨ 多平台支持（Windows、Linux、macOS）

### 功能特性
- 📊 实时性能监控（CPU、内存、执行时间）
- 🔐 基于角色的权限控制（RBAC）
- 💾 SQLite数据库存储
- 🔌 可扩展的插件架构
- 📝 详细的执行日志
- 🎨 美观的现代化界面
- 🔄 自动备份功能
- 📈 执行结果分析
- 🧪 测试套件管理
- 🔍 脚本浏览器

### 技术栈
- Python 3.8+
- PyQt5 - GUI框架
- SQLAlchemy - ORM
- bcrypt - 密码加密
- PyInstaller - 打包工具

### 文档
- 📖 完整的开发文档
- 📖 API接口文档
- 📖 插件开发指南
- 📖 部署指南
- 📖 架构设计文档

---

## 版本说明

### 版本号格式
- **主版本号（Major）**: 不兼容的API修改
- **次版本号（Minor）**: 向下兼容的功能性新增
- **修订号（Patch）**: 向下兼容的问题修正

### 更新类型
- **新增**: 新功能
- **变更**: 现有功能的变更
- **修复**: Bug修复
- **移除**: 移除的功能
- **安全**: 安全相关的修复
- **性能**: 性能优化
- **文档**: 文档更新

---

## 贡献指南

如果您想为本项目做出贡献，请：

1. Fork 本仓库
2. 创建您的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启一个 Pull Request

---

## 链接

- [项目主页](https://github.com/YWB9806/OBC-DCDC-AutoTest)
- [问题反馈](https://github.com/YWB9806/OBC-DCDC-AutoTest/issues)
- [发布页面](https://github.com/YWB9806/OBC-DCDC-AutoTest/releases)

---

**注意**: 本文件遵循 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/) 规范。