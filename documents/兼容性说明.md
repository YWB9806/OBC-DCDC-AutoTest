# 兼容性说明

## 📋 技术栈版本

本项目使用以下技术栈：

- **Python**: 3.8+
- **GUI框架**: PyQt5
- **ORM**: SQLAlchemy
- **密码加密**: bcrypt
- **打包工具**: PyInstaller

## 🔄 PyQt5 vs PyQt6 差异

### 主要差异

1. **导入路径相同**
   ```python
   # PyQt5 和 PyQt6 导入路径相同
   from PyQt5.QtWidgets import QDialog, QPushButton
   from PyQt5.QtCore import QTimer, pyqtSignal
   from PyQt5.QtGui import QFont, QIcon
   ```

2. **exec() vs exec_()**
   ```python
   # PyQt5 使用 exec_()
   dialog.exec_()
   
   # PyQt6 使用 exec()
   dialog.exec()
   ```

3. **setMarkdown() 支持**
   ```python
   # PyQt6 支持 setMarkdown()
   text_edit.setMarkdown(markdown_text)
   
   # PyQt5 不支持，使用 setPlainText() 或 setHtml()
   text_edit.setPlainText(plain_text)
   text_edit.setHtml(html_text)
   ```

## ✅ 已修改的文件

### 1. 核心代码文件
- ✅ `AppCode/ui/update_dialog.py` - 改为PyQt5，使用exec_()和setPlainText()
- ✅ `build.spec` - 添加PyQt5依赖，排除PyQt6

### 2. 配置文件
- ✅ `.github/workflows/release.yml` - Python版本改为3.8

### 3. 文档文件
- ✅ `CHANGELOG.md` - 技术栈更新为Python 3.8+ / PyQt5
- ✅ `documents/发布部署指南.md` - Python版本说明
- ✅ `documents/版本发布系统说明.md` - 代码示例更新为PyQt5
- ✅ `documents/快速开始-版本发布.md` - 代码示例更新为PyQt5
- ✅ `deploy/README.md` - Python版本说明

## 🔧 集成到现有项目

### 确认现有依赖

检查你的 `requirements.txt` 是否包含：

```txt
PyQt5>=5.15.0
PyQt5-Qt5>=5.15.0
PyQt5-sip>=12.8.0
```

### 导入检查

在主窗口文件中添加：

```python
from PyQt5.QtWidgets import QMainWindow, QAction
from PyQt5.QtCore import QTimer
from AppCode.ui.update_dialog import show_update_dialog
```

### 版本检查

```python
import sys
print(f"Python版本: {sys.version}")

from PyQt5.QtCore import QT_VERSION_STR
print(f"PyQt5版本: {QT_VERSION_STR}")
```

## ⚠️ 注意事项

1. **Python 3.8 兼容性**
   - 避免使用 Python 3.9+ 的新特性（如 `dict | dict` 合并语法）
   - 使用 `typing.Dict` 而不是 `dict` 作为类型注解
   - 避免使用 `match-case` 语句（Python 3.10+）

2. **PyQt5 限制**
   - 不支持 `setMarkdown()` 方法
   - 使用 `exec_()` 而不是 `exec()`
   - 某些新的Qt6特性不可用

3. **打包注意**
   - 确保 `build.spec` 中排除了 PyQt6
   - 包含所有 PyQt5 相关的隐藏导入

## 🧪 测试清单

发布前请测试：

- [ ] Python 3.8 环境下运行正常
- [ ] PyQt5 界面显示正常
- [ ] 更新检查功能正常
- [ ] 更新对话框显示正常
- [ ] 本地打包成功
- [ ] 打包后的程序可以运行

## 📞 问题反馈

如遇到兼容性问题，请检查：

1. Python版本是否为3.8+
2. PyQt5是否正确安装
3. 依赖版本是否匹配

---

**最后更新**: 2025-12-13