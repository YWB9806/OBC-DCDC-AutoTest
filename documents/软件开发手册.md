# Python脚本批量执行工具 - 软件开发手册 (v2.0)

## 文档版本信息
- **版本**: v2.0
- **创建日期**: 2024-12-11
- **最后更新**: 2024-12-11
- **维护人员**: 开发团队
- **变更说明**: 根据架构评审意见进行全面改进，采用分层架构+MVVM模式

---

## 📚 文档导航

本项目采用模块化文档结构，各专题文档详细说明如下：

### 1. [架构改进摘要](./架构改进摘要.md)
**内容概要**: 
- 架构设计改进点总结
- 技术实现增强说明
- 数据管理优化方案
- 安全性和可靠性增强
- 新增功能模块说明

**适用人群**: 项目经理、架构师、技术负责人

---

### 2. [架构设计文档](./架构设计文档.md)
**内容概要**:
- 分层架构详细说明（表示层、应用服务层、领域层、基础设施层）
- MVVM模式应用
- 模块划分和职责定义
- 核心接口定义（IScriptManager、IExecutionEngine、IDataAccess等）
- 依赖注入和依赖关系
- 插件系统架构
- 架构决策记录(ADR)

**适用人群**: 架构师、高级开发工程师

**关键章节**:
- 第2章: 架构模式 - 理解系统整体架构
- 第4章: 核心接口定义 - 模块间通信规范
- 第5章: 依赖关系 - 依赖注入实现
- 第6章: 扩展机制 - 插件开发指南

---

### 3. [数据库设计文档](./数据库设计文档.md)
**内容概要**:
- 数据库选型和ER图
- 完整的表结构设计（9张核心表）
  - execution_history: 执行历史表
  - batch_execution: 批次执行表
  - performance_metrics: 性能监控表
  - users: 用户表
  - schema_version: 版本管理表
  - 等
- 索引设计策略
- 数据库迁移管理
- 数据访问层（仓储模式）
- 性能优化方案

**适用人群**: 数据库设计师、后端开发工程师

**关键章节**:
- 第2章: 表结构设计 - 详细的表定义和字段说明
- 第3章: 索引设计 - 查询优化
- 第4章: 数据库迁移 - 版本管理实现
- 第5章: 数据访问层 - 仓储模式实现

---

### 4. [API接口文档](./API接口文档.md)
**内容概要**:
- RESTful API设计规范
- 认证授权机制（Token认证）
- 完整的接口列表
  - 脚本管理接口
  - 脚本执行接口
  - 执行历史接口
  - 统计分析接口
  - 用户管理接口
- 数据模型定义（TypeScript接口）
- 错误处理规范
- Python和cURL使用示例

**适用人群**: API开发工程师、前端开发工程师、集成人员

**关键章节**:
- 第2章: 认证授权 - Token获取和使用
- 第3章: 接口列表 - 完整的API定义
- 第5章: 错误处理 - 统一的错误响应格式
- 第6章: 使用示例 - 实际调用代码

---

### 5. [开发规范文档](./开发规范文档.md)
**内容概要**:
- Python代码规范（PEP 8）
- 命名规范（模块、类、函数、变量）
- 注释规范（文档字符串、行内注释）
- Git规范（分支策略、提交信息）
- 测试规范（单元测试、覆盖率）
- 文档规范（README、API文档、变更日志）
- 代码审查清单
- 性能优化指南
- 安全编码规范

**适用人群**: 所有开发人员

**关键章节**:
- 第1章: 代码规范 - 必须遵循的编码标准
- 第3章: 注释规范 - 文档字符串编写
- 第4章: Git规范 - 版本控制最佳实践
- 第5章: 测试规范 - 测试编写指南

---

## 🎯 项目概述

### 项目背景
本项目旨在开发一款基于PyQt5的桌面应用程序，用于批量管理和执行Python测试脚本。目标用户为汽车电子测试工程师，需要对大量自动化测试脚本进行组织、执行和结果管理。

### 核心功能
- **脚本管理**: 树形浏览、搜索、过滤、分类管理
- **批量执行**: **顺序执行**（车载ECU测试专用，硬件资源独占）、进度监控、实时输出
- **结果分析**: 统计报告、趋势分析、多格式导出
- **历史记录**: 执行历史、日志管理、高级查询
- **配置管理**: 执行参数、系统设置、用户偏好
- **性能监控**: 资源使用监控、性能指标分析
- **数据备份**: 自动/手动备份、数据恢复
- **权限管理**: 用户角色管理（管理员/普通用户）
- **插件系统**: 功能扩展、自定义报告
- **API接口**: RESTful API（支持CI/CD集成）

### 技术栈
- **UI框架**: PyQt5 5.15+
- **Python版本**: Python 3.8+
- **数据存储**: SQLite 3.x
- **日志系统**: logging + RotatingFileHandler
- **并发处理**: QThread + multiprocessing.Pool
- **缓存系统**: functools.lru_cache + 自定义LRU
- **API框架**: Flask/FastAPI (预留)
- **测试框架**: pytest + pytest-qt
- **打包工具**: PyInstaller

---

## 📋 开发计划

### 阶段1: 基础架构搭建（2周）
- 创建项目目录结构
- 实现基础设施层（数据库、日志、配置）
- 实现核心接口定义
- 实现异常体系

### 阶段2: 核心功能实现（4周）
- 领域层实现（脚本管理器、执行引擎、结果分析器）
- 应用服务层实现（各种Service）
- 数据访问层实现（仓储模式）

### 阶段3: UI层实现（3周）
- 基础UI框架（主窗口、控件）
- ViewModels实现
- 信号/槽连接

### 阶段4: 高级功能（3周）
- 性能监控系统
- 数据备份系统
- 用户权限管理
- 插件系统基础接口
- RESTful API（预留）

### 阶段5: 测试与优化（2周）
- 单元测试（覆盖率80%+）
- 集成测试
- 性能优化
- 文档完善

---

## 🚀 快速开始

### 环境准备
```bash
# 克隆项目
git clone <repository_url>
cd Python脚本批量执行工具

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

### 运行应用
```bash
# 方式1：直接运行
python run.py

# 方式2：模块方式
python -m AppCode.main
```

### 执行模式说明
**重要**: 本工具专为车载ECU测试设计，采用**顺序执行模式**。

**原因**:
- 车载ECU测试需要控制物理硬件设备
- 硬件资源（CAN总线、电源、负载等）是独占的
- 同一时间只能执行一个测试脚本
- 多个脚本并行会导致硬件冲突和测试失败

**配置**:
```json
{
  "execution": {
    "max_workers": 1,
    "timeout": 3600,
    "mode": "sequential"
  }
}
```

**注意**: `max_workers` 参数固定为1，不可修改。

### 运行测试
```bash
pytest tests/
```

---

## 📖 文档阅读建议

### 新成员入门路径
1. 阅读本文档（软件开发手册）- 了解项目全貌
2. 阅读[架构改进摘要](./架构改进摘要.md) - 理解改进点
3. 阅读[架构设计文档](./架构设计文档.md) - 深入理解架构
4. 阅读[开发规范文档](./开发规范文档.md) - 学习编码规范
5. 开始编码实践

### 不同角色的阅读重点

**架构师**:
- 架构设计文档（完整阅读）
- 架构改进摘要
- 数据库设计文档

**后端开发**:
- 架构设计文档（第3-5章）
- 数据库设计文档
- API接口文档
- 开发规范文档

**前端开发**:
- 架构设计文档（第2-3章）
- API接口文档
- 开发规范文档（UI相关部分）

**测试工程师**:
- 开发规范文档（第5章）
- API接口文档
- 架构设计文档（第3章）

---

## 🔗 相关资源

### 外部文档
- [PyQt5官方文档](https://www.riverbankcomputing.com/static/Docs/PyQt5/)
- [Python官方文档](https://docs.python.org/3/)
- [SQLite文档](https://www.sqlite.org/docs.html)
- [PEP 8编码规范](https://pep8.org/)

### 项目资源
- 项目仓库: `<repository_url>`
- 问题跟踪: `<issues_url>`
- Wiki: `<wiki_url>`

---

## 📞 联系方式

- **技术支持**: support@example.com
- **开发团队**: dev-team@example.com
- **项目负责人**: pm@example.com

---

## 📝 变更历史

| 版本 | 日期 | 变更说明 | 负责人 |
|------|------|----------|--------|
| v2.0 | 2024-12-11 | 架构全面改进，采用分层架构+MVVM | 开发团队 |
| v1.0 | 2024-12-11 | 初始版本 | 开发团队 |

---

**文档维护**: 开发团队  
**最后更新**: 2024-12-11  
**文档状态**: ✅ 已完成