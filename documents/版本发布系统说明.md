# ç‰ˆæœ¬å‘å¸ƒç³»ç»Ÿå®Œæ•´è¯´æ˜

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å·²åˆ›å»ºçš„å®Œæ•´ç‰ˆæœ¬å‘å¸ƒå’Œè‡ªåŠ¨æ›´æ–°ç³»ç»Ÿã€‚

---

## ğŸ“ å·²åˆ›å»ºçš„æ–‡ä»¶

### 1. æ ¸å¿ƒé…ç½®æ–‡ä»¶

#### `version.py` - ç‰ˆæœ¬é…ç½®
**ä½ç½®**: é¡¹ç›®æ ¹ç›®å½•  
**åŠŸèƒ½**:
- å®šä¹‰åº”ç”¨ç‰ˆæœ¬å·
- é…ç½®æ›´æ–°æ£€æŸ¥å‚æ•°
- æä¾›ç‰ˆæœ¬æ¯”è¾ƒå·¥å…·å‡½æ•°
- ç®¡ç†åº”ç”¨ä¿¡æ¯

**å…³é”®é…ç½®**:
```python
__version__ = "1.0.0"  # å½“å‰ç‰ˆæœ¬
UPDATE_CONFIG = {
    "github_api": "https://api.github.com/repos/yourusername/script-executor/releases/latest",
    "check_interval": 86400,  # 24å°æ—¶
    "auto_check": True,
}
```

---

### 2. æœåŠ¡å±‚

#### `AppCode/services/update_service.py` - æ›´æ–°æ£€æŸ¥æœåŠ¡
**åŠŸèƒ½**:
- ä»GitHub APIè·å–æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯
- æ¯”è¾ƒç‰ˆæœ¬å·
- ç¼“å­˜æ›´æ–°ä¿¡æ¯
- æä¾›ç‰ˆæœ¬æ£€æŸ¥æ¥å£

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from AppCode.services.update_service import get_update_service

service = get_update_service()
update_info = service.check_for_updates(force=True)

if update_info and update_info['has_update']:
    print(f"å‘ç°æ–°ç‰ˆæœ¬: {update_info['latest_version']}")
```

---

### 3. UIå±‚

#### `AppCode/ui/update_dialog.py` - æ›´æ–°æç¤ºå¯¹è¯æ¡†
**åŠŸèƒ½**:
- æ˜¾ç¤ºæ›´æ–°ä¿¡æ¯
- å±•ç¤ºç‰ˆæœ¬å¯¹æ¯”
- æ˜¾ç¤ºæ›´æ–°è¯´æ˜
- æä¾›ä¸‹è½½é“¾æ¥
- æ”¯æŒ"ä¸å†æç¤º"é€‰é¡¹

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from AppCode.ui.update_dialog import show_update_dialog

# åœ¨ä¸»çª—å£å¯åŠ¨æ—¶è°ƒç”¨
show_update_dialog(self, force_check=False)

# æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°
show_update_dialog(self, force_check=True)
```

---

### 4. æ‰“åŒ…é…ç½®

#### `build.spec` - PyInstalleré…ç½®
**åŠŸèƒ½**:
- å®šä¹‰æ‰“åŒ…å‚æ•°
- é…ç½®æ•°æ®æ–‡ä»¶
- è®¾ç½®éšè—å¯¼å…¥
- æ’é™¤ä¸éœ€è¦çš„æ¨¡å—
- æ”¯æŒå¤šå¹³å°æ‰“åŒ…

**ä½¿ç”¨**:
```bash
pyinstaller build.spec
```

---

### 5. è‡ªåŠ¨å‘å¸ƒ

#### `.github/workflows/release.yml` - GitHub Actionsé…ç½®
**åŠŸèƒ½**:
- è‡ªåŠ¨æ„å»ºWindowsã€Linuxã€macOSç‰ˆæœ¬
- åˆ›å»ºGitHub Release
- ä¸Šä¼ å®‰è£…åŒ…
- ç”Ÿæˆå‘å¸ƒè¯´æ˜

**è§¦å‘æ–¹å¼**:
```bash
# æ¨é€ç‰ˆæœ¬æ ‡ç­¾
git tag -a v1.0.0 -m "Release 1.0.0"
git push origin v1.0.0
```

---

### 6. å‘å¸ƒè„šæœ¬

#### `release.sh` (Linux/macOS)
**åŠŸèƒ½**:
- è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹
- æ£€æŸ¥å·¥ä½œç›®å½•
- æäº¤æ›´æ”¹
- åˆ›å»ºæ ‡ç­¾
- æ¨é€åˆ°è¿œç¨‹

**ä½¿ç”¨**:
```bash
chmod +x release.sh
./release.sh 1.0.0
```

#### `release.bat` (Windows)
**åŠŸèƒ½**: åŒä¸Šï¼ŒWindowsç‰ˆæœ¬

**ä½¿ç”¨**:
```cmd
release.bat 1.0.0
```

---

### 7. éƒ¨ç½²è„šæœ¬

#### `deploy/build_all.sh` - æœ¬åœ°æ„å»ºè„šæœ¬
**åŠŸèƒ½**:
- æœ¬åœ°æ„å»ºåº”ç”¨
- è‡ªåŠ¨æ£€æµ‹å¹³å°
- åˆ›å»ºå‹ç¼©åŒ…
- å¯é€‰æµ‹è¯•è¿è¡Œ

**ä½¿ç”¨**:
```bash
cd deploy
chmod +x build_all.sh
./build_all.sh
```

---

### 8. æ–‡æ¡£

#### `CHANGELOG.md` - æ›´æ–°æ—¥å¿—
**åŠŸèƒ½**:
- è®°å½•ç‰ˆæœ¬æ›´æ–°å†…å®¹
- éµå¾ªKeep a Changelogè§„èŒƒ

#### `documents/å‘å¸ƒéƒ¨ç½²æŒ‡å—.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—
**å†…å®¹**:
- ç‰ˆæœ¬ç®¡ç†è§„èŒƒ
- æœ¬åœ°æ‰“åŒ…æ­¥éª¤
- è‡ªåŠ¨å‘å¸ƒæµç¨‹
- æ‰‹åŠ¨å‘å¸ƒæµç¨‹
- å¸¸è§é—®é¢˜è§£ç­”

#### `deploy/README.md` - éƒ¨ç½²è„šæœ¬è¯´æ˜
**å†…å®¹**:
- è„šæœ¬ä½¿ç”¨è¯´æ˜
- æ„å»ºé…ç½®
- å¤šå¹³å°æ„å»º
- é—®é¢˜æ’æŸ¥

---

## ğŸš€ å®Œæ•´å‘å¸ƒæµç¨‹

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨å‘å¸ƒï¼ˆæ¨èï¼‰

1. **æ›´æ–°ç‰ˆæœ¬å·**
   ```python
   # ç¼–è¾‘ version.py
   __version__ = "1.1.0"
   VERSION = {
       "major": 1,
       "minor": 1,
       "patch": 0,
       "release_date": "2025-12-13",
   }
   ```

2. **æ›´æ–°CHANGELOG**
   ```markdown
   # ç¼–è¾‘ CHANGELOG.md
   ## [1.1.0] - 2025-12-13
   ### æ–°å¢
   - æ–°åŠŸèƒ½æè¿°
   ```

3. **è¿è¡Œå‘å¸ƒè„šæœ¬**
   ```bash
   # Linux/macOS
   ./release.sh 1.1.0
   
   # Windows
   release.bat 1.1.0
   ```

4. **ç­‰å¾…è‡ªåŠ¨æ„å»º**
   - GitHub Actionsè‡ªåŠ¨æ„å»ºæ‰€æœ‰å¹³å°
   - è‡ªåŠ¨åˆ›å»ºRelease
   - è‡ªåŠ¨ä¸Šä¼ å®‰è£…åŒ…

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å‘å¸ƒ

1. **æœ¬åœ°æ„å»º**
   ```bash
   cd deploy
   ./build_all.sh
   ```

2. **åˆ›å»ºGitHub Release**
   - è®¿é—®GitHubä»“åº“
   - åˆ›å»ºæ–°Release
   - ä¸Šä¼ æ„å»ºçš„å®‰è£…åŒ…

---

## ğŸ”„ é›†æˆæ›´æ–°æ£€æŸ¥åˆ°åº”ç”¨

### 1. åœ¨ä¸»çª—å£ä¸­æ·»åŠ æ›´æ–°æ£€æŸ¥

ç¼–è¾‘ `AppCode/ui/main_window.py`:

```python
from AppCode.ui.update_dialog import show_update_dialog
from PyQt5.QtCore import QTimer

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.init_ui()
        
        # å¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–°ï¼ˆå»¶è¿Ÿ3ç§’ï¼‰
        QTimer.singleShot(3000, self.check_updates_on_startup)
    
    def check_updates_on_startup(self):
        """å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°"""
        try:
            show_update_dialog(self, force_check=False)
        except Exception as e:
            self.logger.error(f"æ£€æŸ¥æ›´æ–°å¤±è´¥: {e}")
    
    def on_check_updates_action(self):
        """æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°èœå•é¡¹"""
        show_update_dialog(self, force_check=True)
```

### 2. æ·»åŠ èœå•é¡¹

```python
from PyQt5.QtWidgets import QAction

def create_menu_bar(self):
    menubar = self.menuBar()
    
    # å¸®åŠ©èœå•
    help_menu = menubar.addMenu("å¸®åŠ©(&H)")
    
    # æ£€æŸ¥æ›´æ–°
    check_update_action = QAction("æ£€æŸ¥æ›´æ–°", self)
    check_update_action.setShortcut("Ctrl+U")
    check_update_action.triggered.connect(self.on_check_updates_action)
    help_menu.addAction(check_update_action)
    
    # å…³äº
    about_action = QAction("å…³äº", self)
    about_action.triggered.connect(self.show_about_dialog)
    help_menu.addAction(about_action)
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### 1. ä¿®æ”¹GitHubä»“åº“åœ°å€

ç¼–è¾‘ `version.py`:
```python
UPDATE_CONFIG = {
    "github_api": "https://api.github.com/repos/YOUR_USERNAME/YOUR_REPO/releases/latest",
}
```

### 2. ä¿®æ”¹æ›´æ–°æ£€æŸ¥é—´éš”

```python
UPDATE_CONFIG = {
    "check_interval": 86400,  # ç§’ï¼Œé»˜è®¤24å°æ—¶
}
```

### 3. ç¦ç”¨è‡ªåŠ¨æ£€æŸ¥

```python
UPDATE_CONFIG = {
    "auto_check": False,  # ç¦ç”¨è‡ªåŠ¨æ£€æŸ¥
}
```

---

## ğŸ“Š ç‰ˆæœ¬å‘å¸ƒæ£€æŸ¥æ¸…å•

### å‘å¸ƒå‰
- [ ] ç‰ˆæœ¬å·å·²æ›´æ–°ï¼ˆversion.pyï¼‰
- [ ] CHANGELOGå·²æ›´æ–°
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] GitHubä»“åº“åœ°å€å·²é…ç½®
- [ ] ä»£ç å·²æäº¤

### å‘å¸ƒä¸­
- [ ] è¿è¡Œå‘å¸ƒè„šæœ¬
- [ ] æ£€æŸ¥GitHub Actionsæ„å»ºçŠ¶æ€
- [ ] éªŒè¯Releaseåˆ›å»ºæˆåŠŸ
- [ ] ç¡®è®¤æ‰€æœ‰å¹³å°å®‰è£…åŒ…å·²ä¸Šä¼ 

### å‘å¸ƒå
- [ ] ä¸‹è½½å¹¶æµ‹è¯•å„å¹³å°å®‰è£…åŒ…
- [ ] éªŒè¯æ›´æ–°æ£€æŸ¥åŠŸèƒ½
- [ ] æ›´æ–°é¡¹ç›®README
- [ ] é€šçŸ¥ç”¨æˆ·

---

## ğŸ› æ•…éšœæ’æŸ¥

### æ›´æ–°æ£€æŸ¥å¤±è´¥

**é—®é¢˜**: æ— æ³•è¿æ¥åˆ°GitHub API

**è§£å†³**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. éªŒè¯GitHubä»“åº“åœ°å€
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶

### æ„å»ºå¤±è´¥

**é—®é¢˜**: PyInstalleræ„å»ºå¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®Œæ•´
2. æŸ¥çœ‹build.specé…ç½®
3. æ¸…ç†æ—§çš„æ„å»ºæ–‡ä»¶
4. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

### GitHub Actionså¤±è´¥

**é—®é¢˜**: è‡ªåŠ¨æ„å»ºå¤±è´¥

**è§£å†³**:
1. æŸ¥çœ‹Actionsæ—¥å¿—
2. æ£€æŸ¥workflowé…ç½®
3. éªŒè¯secretsé…ç½®
4. ç¡®è®¤æƒé™è®¾ç½®

---

## ğŸ“ è·å–å¸®åŠ©

- ğŸ“– [å‘å¸ƒéƒ¨ç½²æŒ‡å—](./å‘å¸ƒéƒ¨ç½²æŒ‡å—.md)
- ğŸ“– [éƒ¨ç½²è„šæœ¬è¯´æ˜](../deploy/README.md)
- ğŸ› [æäº¤Issue](https://github.com/YWB9806/OBC-DCDC-AutoTest/issues)
- ğŸ“§ Email: your.email@example.com

---

**åˆ›å»ºæ—¥æœŸ**: 2025-12-13  
**æœ€åæ›´æ–°**: 2025-12-13  
**ç‰ˆæœ¬**: 1.0.0